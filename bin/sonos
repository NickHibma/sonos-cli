#!/usr/bin/env node

var minimist = require('minimist')
var sonos = require('sonos')
var pkg = require('../package.json')
var getInitialDevice = require('../lib/getInitialDevice')

var argv = minimist(process.argv.slice(2))
var command = argv._[0]
var timeout = ((argv.timeout || argv.T) * 1000) || 5000

if (argv.version || argv.V) {
  console.log(pkg.version)
} else if (command === 'help') {
  console.log('Usage: sonos-cli [OPTION...] [COMMAND] [ARGS]')
  console.log('')
  console.log('  Options:')
  console.log('    -V --version - displays package.json version')
  console.log('    -H --help - displays help')
  console.log('    -T --timeout - sets timeout time for sonos discovery')
  console.log('')
  console.log('  Commands:')
  console.log('')
  console.log('    help - display this help text')
  console.log('    play - starts music')
  console.log('    stop - stops music')
  console.log('    next - skips to next track')
  console.log('    current - Displays current media item')
  console.log('')
} else if (command === 'list-zones') {
  getInitialDevice(timeout, function (err, initDevice) {
    if (err) throw err
    require('../cmds/listZones')(initDevice)
  })
} else if (command === 'list-devices') {
  getInitialDevice(timeout, function (err, initDevice) {
    if (err) throw err
    require('../cmds/listDevices')(initDevice)
  })
} else {
  console.log('For help, run `sonos-cli help`')
}






